"use strict";function min(a,b){return b>a?a:b}function identity(a){return a}function map(a,b){var c,d=[];for(c=0;c<a.length;c++)d.push(b(a[c]));return d}function filter(a,b){var c,d=[];for(c=0;c<a.length;c++)b(a[c])&&d.push(a[c]);return d}function IO(a){this.unsafePerformIO=a,this.timer=null}IO.of=function(a){return new IO(function(){return a})},IO.prototype.chain=function(a){var b=this;return new IO(function(){return a(b.unsafePerformIO()).unsafePerformIO()})},IO.prototype.fork=function(){var a=this;return new IO(function(){setTimeout(function(){a.unsafePerformIO()},25)})},function(){function a(a,c){var d=a.getBoundingClientRect();return new b(c.clientX-d.left,c.clientY-d.top)}function b(a,b){this.x=a,this.y=b}function c(a,b){this.board=a,this.pos=b}function d(a){return a.x>=0&&a.y>=0&&a.x<r&&a.y<r}function e(a){var c=[new b(-1,-1),new b(-1,0),new b(-1,1),new b(0,-1),new b(0,1),new b(1,-1),new b(1,0),new b(1,1)],e=filter(map(c,function(c){return new b(a.pos.x+c.x,a.pos.y+c.y)}),d);return map(e,function(b){return a.updatePos(b).extract()})}function f(a){return filter(e(a),identity).length}function g(a){var b=a.extract(),c=f(a);return b&&(2>c||c>3)?!1:b&&2==c||3==c||b}function h(){return new IO(function(){var a,d,e=[];for(d=0;r>d;d++)for(e[d]=[],a=0;r>a;a++)e[d][a]=!1;return new c(e,new b(0,0))})}function i(a){return new IO(function(){var b,c;for(c=0;c<a.length;c++)for(b=0;b<a[c].length;b++)a[c][b]?q.fillRect(b,c,1,1):q.clearRect(b,c,1,1)})}function j(a){return a.extend(g)}function k(a){var b=i(a.board);return b.chain(s?function(){return k(j(a)).fork()}:function(){return k(identity(a)).fork()})}function l(b){q.canvas.addEventListener("click",function(c){var d=a(this,c);d.x=Math.floor(d.x/o),d.y=Math.floor(d.y/o),t&&!s&&(console.log(d),b.board[d.y][d.x]=b.board[d.y][d.x]?!1:!0)}),$("#clear-button").click(function(){var a,c;for(c=0;r>c;c++)for(a=0;r>a;a++)b.board[c][a]=!1}),$("#pause-button ").click(function(){s=!s,t=!t,$(this).text(s?"Pause to edit":"Resume"),$(this).css("class",s?"":"active")})}var m,n,o,i,p=document.getElementById("the-canvas"),q=p.getContext("2d"),r=100,s=!1,t=!0;c.prototype.updatePos=function(a){return this.pos=a,this},c.prototype.extract=function(){return this.board[this.pos.y][this.pos.x]},c.prototype.extend=function(a){var d,e,f=[];for(d=0;d<this.board.length;d++)for(f[d]=[],e=0;e<this.board[d].length;e++)f[d][e]=a(new c(this.board,new b(e,d)));return this.board=f,this},n=new IO(function(){var a=min(window.innerWidth,window.innerHeight)-120;p.width=a,p.height=a,o=a/r,q.scale(o,o)}),m=n.chain(h).chain(function(a){return new IO(function(){return l(a),a})}).chain(k),m.unsafePerformIO()}();